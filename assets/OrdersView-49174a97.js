import{F as _,P as d}from"./router-541adf43.js";import{a8 as c,ad as y,aX as f,ag as o,af as g,ah as k,a7 as h,r as x,b5 as q}from"./_plugin-vue_export-helper-0effeee0.js";import{c as P}from"./headers-b2d32875.js";import{_ as r}from"./DataTable-17e19d67.js";import{_ as T}from"./Divider-ea7a148e.js";import"./PersonOutline-c658c387.js";import"./Icon-c6deeddd.js";import"./light-1cf01424.js";const F={__name:"OrdersView",setup(w){const l=_(),s=c([]);(async()=>{var n,a;try{const{data:t}=await d.get("/orders/all");s.push(...t.result.map((e,u)=>(e.totalPrice="$"+e.products.reduce((m,i)=>m+i.p_id.price*i.quantity,0),e.key=u+1,e.date=new Date(e.date).toLocaleDateString(),e.user=e.u_id.account,e)))}catch(t){console.log(t),l.error({title:"失敗",content:((a=(n=t==null?void 0:t.response)==null?void 0:n.data)==null?void 0:a.message)||"取得訂單失敗",positiveText:"再試一次"})}})();const p=c([{type:"expand",renderExpand:n=>{const a=[];for(const t of n.products)a.push({name:t.p_id.name,price:t.p_id.price,quantity:t.quantity,productsTotalPrice:t.p_id.price*t.quantity});return x(r,{size:"small",columns:[{title:"商品名稱",key:"name"},{title:"單價",key:"price"},{title:"數量",key:"quantity"},{title:"商品金額",key:"productsTotalPrice"}],data:a},{})}},{title:"訂單編號",key:"_id"},{title:"訂購人",key:"user"},{title:"日期",key:"date"},{title:"訂單金額",key:"totalPrice"}]);return(n,a)=>{const t=P,e=T;return y(),f(h,null,[o(t,{class:"pageTitle"},{default:g(()=>[q(" 訂單管理 ")]),_:1}),o(e),o(k(r),{size:"large",columns:p,data:s,"default-expand-all":""},null,8,["columns","data"])],64)}}};export{F as default};
