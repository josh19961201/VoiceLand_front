import{ad as O}from"./PersonOutline-c658c387.js";import{F as T,G as q,H as D,P as R,W as v,L as j,_ as z,z as F}from"./router-541adf43.js";import{b3 as G,J as b,a8 as h,ad as H,aX as M,aY as y,ag as t,af as r,b5 as c}from"./_plugin-vue_export-helper-0effeee0.js";import{_ as P}from"./FormItemGridItem-5b3202e8.js";import{c as W}from"./headers-b2d32875.js";import{N as A,_ as I}from"./Divider-ea7a148e.js";import"./Icon-c6deeddd.js";const J={class:"container"},L={class:"inside",style:{padding:"0 5rem"}},S={class:"btnGroup"},X={__name:"OrderBuildView",setup(Y){const m=T(),w=q(),f=O(),E=D(),d=b(!1),g=b(!1),{checkout:k}=E,a=h({}),p=h({}),x={name:{required:!0,validator(o,e){if(!e)return new Error("請輸入姓名")},trigger:["input","blur"]},email:{required:!0,validator(o,e){if(e){if(!v.isEmail(e))return new Error("Email格式錯誤")}else return new Error("請輸入Email");return!0},trigger:["input","blur"]},mobilephone:{required:!0,validator(o,e){if(e){if(e&&!v.isMobilePhone(e,"zh-TW"))return new Error("手機格式錯誤")}else return new Error("請輸入Email");return!0},trigger:["input","blur"]},address:{required:!0,trigger:["input","blur"]}},B=async()=>{f.push("/cart")},U=async()=>{var o;(o=g.value)==null||o.validate(async e=>{var n,l;if(e)w.error("請檢查資料是否完整");else{d.value=!0;try{await k(),f.push("/ordercomplete")}catch(i){m.error({title:"失敗",content:((l=(n=i==null?void 0:i.response)==null?void 0:n.data)==null?void 0:l.message)||"發生錯誤",positiveText:"確認"})}d.value=!1}})},C=()=>Object.assign(a,p);return(async()=>{var o,e;try{const n=await R.get("/users/me");Object.assign(p,n.data.result),console.log(p)}catch(n){m.error({title:"失敗",content:((e=(o=n==null?void 0:n.response)==null?void 0:o.data)==null?void 0:e.message)||"取得資料失敗",positiveText:"再試一次"})}})(),(o,e)=>{const n=W,l=A,i=I,u=z,_=P,N=F,V=j;return H(),M("div",J,[y("div",L,[t(n,{class:"pageTitle"},{default:r(()=>[c(" 填寫收件資料 ")]),_:1}),t(l,{style:{width:"150px","align-self":"center"},onClick:C},{default:r(()=>[c(" 載入會員資料 ")]),_:1}),t(i),t(V,{ref_key:"formRef",ref:g,model:a,rules:x},{default:r(()=>[t(N,{cols:12,"x-gap":48,"y-gap":24},{default:r(()=>[t(_,{span:6,label:"收件人",path:"name"},{default:r(()=>[t(u,{value:a.name,"onUpdate:value":e[0]||(e[0]=s=>a.name=s),placeholder:"請輸入真實姓名，以免影響收貨權益"},null,8,["value"])]),_:1}),t(_,{span:6,label:"Eamil",path:"email"},{default:r(()=>[t(u,{value:a.email,"onUpdate:value":e[1]||(e[1]=s=>a.email=s),placeholder:"請輸入電子信箱"},null,8,["value"])]),_:1}),t(_,{span:6,label:"手機",path:"mobilephone"},{default:r(()=>[t(u,{value:a.mobilephone,"onUpdate:value":e[2]||(e[2]=s=>a.mobilephone=s),placeholder:"請輸入手機"},null,8,["value"])]),_:1}),t(_,{span:6,label:"收件地址",path:"address"},{default:r(()=>[t(u,{value:a.address,"onUpdate:value":e[3]||(e[3]=s=>a.address=s),placeholder:"請輸入收件地址"},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["model"]),y("div",S,[t(l,{onClick:B},{default:r(()=>[c(" 回購物車 ")]),_:1}),t(l,{loading:d.value,type:"primary",onClick:U},{default:r(()=>[c(" 送出訂單 ")]),_:1},8,["loading"])])])])}}},ne=G(X,[["__scopeId","data-v-0294c693"]]);export{ne as default};
