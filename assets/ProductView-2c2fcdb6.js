import{F as H,G as P,H as S,I as $,z,J as D,A as E,K as I,L as J,M as L}from"./router-541adf43.js";import{ar as M,ad as U}from"./PersonOutline-c658c387.js";import{b3 as j,J as y,a8 as A,ad as m,ae as v,af as n,ag as s,aY as G,aX as K,b9 as O,a7 as X,b5 as c,b8 as d}from"./_plugin-vue_export-helper-0effeee0.js";import{_ as Y}from"./InputNumber-5c07de95.js";import{_ as Q}from"./Image-18d9eb91.js";import{c as W,N as Z}from"./headers-b2d32875.js";import{N as ee}from"./Divider-ea7a148e.js";import"./Icon-c6deeddd.js";import"./light-559d9d21.js";import"./Remove-ea49db6b.js";import"./light-07f515f4.js";const te={class:"carouselOut"},ne={__name:"ProductView",setup(se){const r=H(),x=P(),b=M(),p=U(),h=S(),{editCart:w}=h,f=y(null),i=y({quantity:1}),q={quantity:{type:"number",required:!0,validator(t,a){return!a||!/^[1-9]\d*$/.test(a)?new Error("請輸入正確的數量"):!0}}},e=A({_id:"",name:"",price:0,description:"",images:[],sell:!0,category:""}),N=()=>{var t;(t=f.value)==null||t.validate(async a=>{var _,u;if(a)x.error("請輸入正確的數量");else try{const o=await w({_id:e._id,quantity:i.value.quantity});o.length===0?r.success({title:"成功",content:"您新增了 "+i.value.quantity+" 個 "+e.name+" 到購物車",positiveText:"確認"}):o===-1?(r.error({title:"錯誤",content:"請登入帳號",positiveText:"確認"}),p.push("/login")):r.error({title:"加入購物車失敗",content:o,positiveText:"確認"})}catch(o){r.error({title:"加入購物車失敗",content:((u=(_=o==null?void 0:o.response)==null?void 0:_.data)==null?void 0:u.message)||"發生錯誤",positiveText:"確認"})}})};return(async()=>{try{const{data:t}=await $.get("/products/"+b.params.id);e._id=t.result._id,e.name=t.result.name,e.price=t.result.price,e.description=t.result.description,e.images=t.result.images,e.sell=t.result.sell,e.category=t.result.category,document.title="Shop | "+e.name,e.sell||(r.error({title:"錯誤",content:"商品未上架",positiveText:"確認"}),p.go(-1))}catch{r.error({title:"錯誤",content:"取得商品失敗",positiveText:"再試一次"}),p.go(-1)}})(),(t,a)=>{const _=Q,u=D,o=E,T=W,g=Z,k=Y,V=I,B=J,R=ee,C=L,F=z;return m(),v(F,{cols:"12","item-responsive":"",responsive:"screen"},{default:n(()=>[s(o,{span:"12 s:6 m:5",class:"content"},{default:n(()=>[G("div",te,[s(u,{"show-arrow":"","space-between":20,draggable:""},{default:n(()=>[(m(!0),K(X,null,O(e.images,l=>(m(),v(_,{key:l,src:l,class:"carousel-img","object-fit":"contain"},null,8,["src"]))),128))]),_:1})])]),_:1}),s(o,{span:"12 s:6 m:7",class:"content info"},{default:n(()=>[s(T,null,{default:n(()=>[c(d(e.name),1)]),_:1}),s(g,null,{default:n(()=>[c("NT$"+d(e.price),1)]),_:1}),s(B,{ref_key:"addRef",ref:f,model:i.value,rules:q,"show-require-mark":!1},{default:n(()=>[s(V,{label:"數量",path:"quantity"},{default:n(()=>[s(k,{value:i.value.quantity,"onUpdate:value":a[0]||(a[0]=l=>i.value.quantity=l)},null,8,["value"])]),_:1})]),_:1},8,["model"]),s(R,{size:"medium",type:"primary",style:{"max-width":"250px"},onClick:N},{default:n(()=>[c(" 加入購物車 ")]),_:1})]),_:1}),s(o,{span:"12",class:"content"},{default:n(()=>[s(g,null,{default:n(()=>[c("商品介紹")]),_:1}),s(C,{style:{"white-space":"pre-line"}},{default:n(()=>[c(d(e.description),1)]),_:1})]),_:1})]),_:1})}}},fe=j(ne,[["__scopeId","data-v-8befc1a2"]]);export{fe as default};
