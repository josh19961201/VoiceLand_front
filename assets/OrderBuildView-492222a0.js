import{a3 as V}from"./vue-router-23be1caa.js";import{B as O,C as T,D as q,S as M,a0 as v,K as j,L as R,P as F,F as G}from"./router-079c6ebf.js";import{aL as K,j as h,G as b,K as L,aD as P,aE as y,N as t,M as r,aM as p}from"./plugin-vueexport-helper-7abb35e5.js";import{_ as S}from"./FormItemGridItem-2a2f8f39.js";import{N as z}from"./headers-04aa7c74.js";import{e as A}from"./Button-4159ae6a.js";import"./Icon-085b31e9.js";const H={class:"container"},I={class:"inside",style:{padding:"0 5rem"}},W={class:"btnGroup"},J={__name:"OrderBuildView",setup(Q){const m=O(),w=T(),f=V(),E=q(),_=h(!1),g=h(!1),{checkout:k}=E,a=b({}),d=b({}),x={name:{required:!0,validator(o,e){if(!e)return new Error("請輸入姓名")},trigger:["input","blur"]},email:{required:!0,validator(o,e){if(e){if(!v.isEmail(e))return new Error("Email格式錯誤")}else return new Error("請輸入Email");return!0},trigger:["input","blur"]},mobilephone:{required:!0,validator(o,e){if(e){if(e&&!v.isMobilePhone(e,"zh-TW"))return new Error("手機格式錯誤")}else return new Error("請輸入Email");return!0},trigger:["input","blur"]},address:{required:!0,trigger:["input","blur"]}},B=async()=>{f.push("/cart")},C=async()=>{var o;(o=g.value)==null||o.validate(async e=>{var n,l;if(e)w.error("請檢查資料是否完整");else{_.value=!0;try{await k(),f.push("/ordercomplete")}catch(i){m.error({title:"失敗",content:((l=(n=i==null?void 0:i.response)==null?void 0:n.data)==null?void 0:l.message)||"發生錯誤",positiveText:"確認"})}_.value=!1}})},N=()=>Object.assign(a,d);return(async()=>{var o,e;try{const n=await M.get("/users/me");Object.assign(d,n.data.result),console.log(d)}catch(n){m.error({title:"失敗",content:((e=(o=n==null?void 0:n.response)==null?void 0:o.data)==null?void 0:e.message)||"取得資料失敗",positiveText:"再試一次"})}})(),(o,e)=>{const n=z,l=A,i=R,u=F,c=S,U=G,D=j;return L(),P("div",H,[y("div",I,[t(n,{class:"pageTitle"},{default:r(()=>[p(" 填寫收件資料 ")]),_:1}),t(l,{style:{width:"150px","align-self":"center"},onClick:N},{default:r(()=>[p(" 載入會員資料 ")]),_:1}),t(i),t(D,{ref_key:"formRef",ref:g,model:a,rules:x},{default:r(()=>[t(U,{cols:12,"x-gap":48,"y-gap":24},{default:r(()=>[t(c,{span:6,label:"收件人",path:"name"},{default:r(()=>[t(u,{value:a.name,"onUpdate:value":e[0]||(e[0]=s=>a.name=s),placeholder:"請輸入真實姓名，以免影響收貨權益"},null,8,["value"])]),_:1}),t(c,{span:6,label:"Eamil",path:"email"},{default:r(()=>[t(u,{value:a.email,"onUpdate:value":e[1]||(e[1]=s=>a.email=s),placeholder:"請輸入電子信箱"},null,8,["value"])]),_:1}),t(c,{span:6,label:"手機",path:"mobilephone"},{default:r(()=>[t(u,{value:a.mobilephone,"onUpdate:value":e[2]||(e[2]=s=>a.mobilephone=s),placeholder:"請輸入手機"},null,8,["value"])]),_:1}),t(c,{span:6,label:"收件地址",path:"address"},{default:r(()=>[t(u,{value:a.address,"onUpdate:value":e[3]||(e[3]=s=>a.address=s),placeholder:"請輸入收件地址"},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["model"]),y("div",W,[t(l,{onClick:B},{default:r(()=>[p(" 回購物車 ")]),_:1}),t(l,{loading:_.value,type:"primary",onClick:C},{default:r(()=>[p(" 送出訂單 ")]),_:1},8,["loading"])])])])}}},ne=K(J,[["__scopeId","data-v-0294c693"]]);export{ne as default};
